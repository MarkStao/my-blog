import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,d as s,a as e,b as l,o as t}from"./app-BImRTQmU.js";const h={};function d(r,i){return t(),n("div",null,[i[0]||(i[0]=s("p",null,"NGINX 是一个高性能的 HTTP 和反向代理服务器，支持高并发、负载均衡等功能，被广泛用于网站流量分发和高可用集群部署，也是现代 Web 开发和运维的核心组件之一。",-1)),i[1]||(i[1]=s("p",null,[s("strong",null,"本文梳理了 NGINX 从基础到高级的全面知识，旨在帮助读者快速入门及掌握核心技能。")],-1)),e(" more "),i[2]||(i[2]=l(`<h2 id="目录" tabindex="-1"><a class="header-anchor" href="#目录"><span>目录</span></a></h2><ol><li><a href="#1-nginx-%E7%AE%80%E4%BB%8B">NGINX 简介</a></li><li><a href="#2-nginx-%E5%AE%89%E8%A3%85%E4%B8%8E%E5%90%AF%E5%8A%A8">NGINX 安装与启动</a></li><li><a href="#3-%E6%A0%B8%E5%BF%83%E9%85%8D%E7%BD%AE%E4%B8%8E%E7%BB%93%E6%9E%84">核心配置与结构</a></li><li><a href="#4-nginx-%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4">NGINX 基本命令</a></li><li><a href="#5-nginx-%E7%9A%84%E5%B8%B8%E8%A7%81%E5%9C%BA%E6%99%AF%E4%B8%8E%E9%85%8D%E7%BD%AE">NGINX 的常见场景与配置</a></li><li><a href="#6-%E6%A8%A1%E5%9D%97%E4%B8%8E%E9%AB%98%E7%BA%A7%E5%8A%9F%E8%83%BD">模块与高级功能</a></li><li><a href="#7-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7">性能优化技巧</a></li><li><a href="#8-nginx-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E4%B8%8E%E6%8E%92%E6%9F%A5">NGINX 常见问题与排查</a></li><li><a href="#9-%E6%80%BB%E7%BB%93">总结</a></li></ol><hr><h2 id="_1-nginx-简介" tabindex="-1"><a class="header-anchor" href="#_1-nginx-简介"><span>1. NGINX 简介</span></a></h2><h3 id="什么是-nginx" tabindex="-1"><a class="header-anchor" href="#什么是-nginx"><span>什么是 NGINX？</span></a></h3><p>NGINX 是一个高性能、高稳定性和高灵活性的 Web 服务器及反向代理服务器，支持以下主要功能：</p><ul><li><strong>静态内容服务</strong>：高效处理 HTML、CSS、JS、图片等静态资源。</li><li><strong>反向代理</strong>：代理客户端请求到后端服务器。</li><li><strong>负载均衡</strong>：多种策略分发请求到多个服务器（如轮询、IP 哈希等）。</li><li><strong>HTTP 缓存</strong>：提高资源访问速度并减轻后端压力。</li><li><strong>HTTPS 支持</strong>：通过证书加密提供安全的网站访问。</li><li><strong>流量控制</strong>：支持速率限制、带宽控制。</li></ul><hr><h2 id="_2-nginx-安装与启动" tabindex="-1"><a class="header-anchor" href="#_2-nginx-安装与启动"><span>2. NGINX 安装与启动</span></a></h2><h3 id="安装-nginx" tabindex="-1"><a class="header-anchor" href="#安装-nginx"><span>安装 NGINX</span></a></h3><h4 id="_2-1-使用包管理工具安装" tabindex="-1"><a class="header-anchor" href="#_2-1-使用包管理工具安装"><span>2.1 使用包管理工具安装</span></a></h4><ol><li><p><strong>Ubuntu/Debian</strong>：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> update</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>CentOS/RHEL</strong>：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> epel-release</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h4 id="_2-2-从源码安装-可自定义模块" tabindex="-1"><a class="header-anchor" href="#_2-2-从源码安装-可自定义模块"><span>2.2 从源码安装（可自定义模块）</span></a></h4><ol><li><p>下载 NGINX 源代码：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://nginx.org/download/nginx-1.24.0.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -xvzf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx-1.24.0.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx-1.24.0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>配置并编译安装：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./configure</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><hr><h3 id="启动与停止服务" tabindex="-1"><a class="header-anchor" href="#启动与停止服务"><span>启动与停止服务</span></a></h3><table><thead><tr><th>操作</th><th>命令</th></tr></thead><tbody><tr><td>启动 NGINX</td><td><code>sudo systemctl start nginx</code></td></tr><tr><td>停止 NGINX</td><td><code>sudo systemctl stop nginx</code></td></tr><tr><td>重启 NGINX</td><td><code>sudo systemctl restart nginx</code></td></tr><tr><td>检查运行状态</td><td><code>sudo systemctl status nginx</code></td></tr></tbody></table><hr><h2 id="_3-核心配置与结构" tabindex="-1"><a class="header-anchor" href="#_3-核心配置与结构"><span>3. 核心配置与结构</span></a></h2><h3 id="nginx-配置文件路径" tabindex="-1"><a class="header-anchor" href="#nginx-配置文件路径"><span>NGINX 配置文件路径</span></a></h3><p>常见默认路径：</p><ul><li>主配置文件：<code>/etc/nginx/nginx.conf</code></li><li>站点配置文件：<code>/etc/nginx/sites-available/</code> 和 <code>/etc/nginx/sites-enabled/</code></li><li>可执行程序：<code>/usr/sbin/nginx</code></li></ul><hr><h3 id="配置文件结构" tabindex="-1"><a class="header-anchor" href="#配置文件结构"><span>配置文件结构</span></a></h3><p>NGINX 使用模块化配置结构，主要分为以下几个部分：</p><table><thead><tr><th>配置块</th><th>描述</th></tr></thead><tbody><tr><td><code>events</code></td><td>设置工作线程和连接数等核心服务控制。</td></tr><tr><td><code>http</code></td><td>HTTP 服务配置，包括网站监听、代理、缓存配置等。</td></tr><tr><td><code>server</code></td><td>定义一个虚拟主机配置，包括域名、监听端口等设置。</td></tr><tr><td><code>location</code></td><td>指定请求路径的匹配规则及要执行的处理逻辑。</td></tr></tbody></table><p><strong>配置文件示例</strong>：</p><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" data-title="nginx" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">user </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">www-data;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">worker_processes </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">auto;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">events</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    worker_connections </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1024</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">http</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    include </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/etc/nginx/mime.types;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    server</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        listen </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">80</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        server_name </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">example.com;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        location</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> / {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            root </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/var/www/html;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            index </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">index.html;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_4-nginx-基本命令" tabindex="-1"><a class="header-anchor" href="#_4-nginx-基本命令"><span>4. NGINX 基本命令</span></a></h2><table><thead><tr><th>命令</th><th>描述</th></tr></thead><tbody><tr><td><code>nginx -v</code></td><td>查看 NGINX 版本</td></tr><tr><td><code>nginx -t</code></td><td>检查配置语法是否正确</td></tr><tr><td><code>nginx -s reload</code></td><td>热加载配置文件</td></tr><tr><td><code>nginx -s stop</code></td><td>停止 NGINX</td></tr></tbody></table><hr><h2 id="_5-nginx-的常见场景与配置" tabindex="-1"><a class="header-anchor" href="#_5-nginx-的常见场景与配置"><span>5. NGINX 的常见场景与配置</span></a></h2><h3 id="_5-1-静态文件服务" tabindex="-1"><a class="header-anchor" href="#_5-1-静态文件服务"><span>5.1 静态文件服务</span></a></h3><p><strong>目标</strong>：将 <code>/var/www/html</code> 目录下的内容作为静态文件服务。</p><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" data-title="nginx" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">server</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    listen </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">80</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    server_name </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">example.com;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    location</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> / {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        root </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/var/www/html;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        index </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">index.html index.htm;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="_5-2-http-转发与反向代理" tabindex="-1"><a class="header-anchor" href="#_5-2-http-转发与反向代理"><span>5.2 HTTP 转发与反向代理</span></a></h3><p><strong>目标</strong>：将客户端请求代理到后端的 Java 应用服务器。</p><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" data-title="nginx" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">server</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    listen </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">80</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    server_name </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">app.example.com;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    location</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> / {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        proxy_pass </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">http://127.0.0.1:8080;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        proxy_set_header </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Host $</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">host</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        proxy_set_header </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">X-Real-IP $</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">remote_addr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="_5-3-负载均衡" tabindex="-1"><a class="header-anchor" href="#_5-3-负载均衡"><span>5.3 负载均衡</span></a></h3><p><strong>目标</strong>：实现多个后端服务器的负载均衡。</p><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" data-title="nginx" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">http</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    upstream</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> myapp {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        server</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> backend1.example.com;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        server</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> backend2.example.com;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    server</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        listen </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">80</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        server_name </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">myapp.example.com;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        location</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> / {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            proxy_pass </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">http://myapp;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>策略示例：</p><ul><li>轮询（默认）：按请求顺序分配。</li><li>权重：<code>server backend1.example.com weight=2;</code></li><li>IP 哈希：<code>ip_hash;</code></li></ul><hr><h3 id="_5-4-https-配置" tabindex="-1"><a class="header-anchor" href="#_5-4-https-配置"><span>5.4 HTTPS 配置</span></a></h3><p><strong>目标</strong>：启用 HTTPS 访问（假设已获取证书）。</p><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" data-title="nginx" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">server</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    listen </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">443</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ssl;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    ssl_certificate </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/etc/nginx/ssl/example.crt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    ssl_certificate_key </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/etc/nginx/ssl/example.key;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    location</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> / {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        root </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/var/www/html;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        index </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">index.html;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_6-模块与高级功能" tabindex="-1"><a class="header-anchor" href="#_6-模块与高级功能"><span>6. 模块与高级功能</span></a></h2><h3 id="常用模块列表" tabindex="-1"><a class="header-anchor" href="#常用模块列表"><span>常用模块列表</span></a></h3><table><thead><tr><th>模块</th><th>功能</th></tr></thead><tbody><tr><td><code>http_ssl_module</code></td><td>支持 HTTPS</td></tr><tr><td><code>http_gzip_module</code></td><td>启用 Gzip 压缩以减少响应大小</td></tr><tr><td><code>stream</code></td><td>支持 TCP/UDP 流量代理</td></tr><tr><td><code>http_cache</code></td><td>实现缓存功能</td></tr><tr><td><code>http_stub_status_module</code></td><td>提供 NGINX 状态监控接口</td></tr></tbody></table><hr><h3 id="日志设置" tabindex="-1"><a class="header-anchor" href="#日志设置"><span>日志设置</span></a></h3><table><thead><tr><th>配置项</th><th>描述</th></tr></thead><tbody><tr><td><code>access_log</code></td><td>记录所有访问请求。</td></tr><tr><td><code>error_log</code></td><td>记录错误信息（日志级别可调）。</td></tr></tbody></table><p>示例：</p><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" data-title="nginx" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">error_log </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/var/log/nginx/error.log </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">warn</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">access_log </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/var/log/nginx/access.log;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="_7-性能优化技巧" tabindex="-1"><a class="header-anchor" href="#_7-性能优化技巧"><span>7. 性能优化技巧</span></a></h2><ol><li><p><strong>调优 Worker 进程和连接数</strong>：</p><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" data-title="nginx" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">worker_processes </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">auto;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">events</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    worker_connections </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1024</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>启用 Gzip 压缩</strong>：</p><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" data-title="nginx" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">gzip_types </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">text/plain text/css application/json application/javascript;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>缓存静态内容</strong>：</p><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" data-title="nginx" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">location</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ~* </span><span style="--shiki-light:#0184BC;--shiki-dark:#E06C75;">\\.(jpg|jpeg|png|css|js|ico)$ </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    expires </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">7d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    access_log </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">off</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>限制请求速率</strong>：</p><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" data-title="nginx" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">limit_req_zone </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">binary_remote_addr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> zone=one:10m rate=10r/s;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">server</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    location</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> / {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        limit_req </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">zone=one;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><hr><h2 id="_8-nginx-常见问题与排查" tabindex="-1"><a class="header-anchor" href="#_8-nginx-常见问题与排查"><span>8. NGINX 常见问题与排查</span></a></h2><h3 id="问题一-服务启动失败" tabindex="-1"><a class="header-anchor" href="#问题一-服务启动失败"><span>问题一：服务启动失败</span></a></h3><p><strong>检查配置语法</strong>：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">nginx</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -t</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>查看错误日志</strong>：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/log/nginx/error.log</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><hr><h3 id="问题二-高并发流量引发-504-gateway-timeout" tabindex="-1"><a class="header-anchor" href="#问题二-高并发流量引发-504-gateway-timeout"><span>问题二：高并发流量引发 504 Gateway Timeout</span></a></h3><p><strong>解决</strong>：</p><ul><li><p>增大后端服务器的 <code>keepalive</code>：</p><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" data-title="nginx" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">upstream</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> backend {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    server</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> backend.example.com;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    keepalive </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>调整超时时间：</p><div class="language-nginx line-numbers-mode" data-highlighter="shiki" data-ext="nginx" data-title="nginx" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">proxy_connect_timeout </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">60s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">proxy_read_timeout </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">60s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">proxy_send_timeout </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">60s</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h2 id="_9-总结" tabindex="-1"><a class="header-anchor" href="#_9-总结"><span>9. 总结</span></a></h2><p>本文详细介绍了 NGINX 的基本概念、安装、配置和性能调优技巧。结合实际项目需求，可以轻松实现静态资源服务、反向代理、负载均衡等功能，并通过高级模块进一步加强其性能与功能扩展。更多细节可参考 <a href="https://nginx.org/" target="_blank" rel="noopener noreferrer">NGINX 官方文档</a>。</p>`,76))])}const g=a(h,[["render",d],["__file","Nginx知识点.html.vue"]]),c=JSON.parse('{"path":"/article/Linux/Nginx%E7%9F%A5%E8%AF%86%E7%82%B9.html","title":"Nginx知识点","lang":"zh-CN","frontmatter":{"title":"Nginx知识点","category":["Linux"],"tag":["Nginx"],"description":"NGINX 是一个高性能的 HTTP 和反向代理服务器，支持高并发、负载均衡等功能，被广泛用于网站流量分发和高可用集群部署，也是现代 Web 开发和运维的核心组件之一。 本文梳理了 NGINX 从基础到高级的全面知识，旨在帮助读者快速入门及掌握核心技能。","head":[["meta",{"property":"og:url","content":"https://java-st.blog.csdn.net/my-blog/article/Linux/Nginx%E7%9F%A5%E8%AF%86%E7%82%B9.html"}],["meta",{"property":"og:site_name","content":"知识库"}],["meta",{"property":"og:title","content":"Nginx知识点"}],["meta",{"property":"og:description","content":"NGINX 是一个高性能的 HTTP 和反向代理服务器，支持高并发、负载均衡等功能，被广泛用于网站流量分发和高可用集群部署，也是现代 Web 开发和运维的核心组件之一。 本文梳理了 NGINX 从基础到高级的全面知识，旨在帮助读者快速入门及掌握核心技能。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-02-27T03:26:46.000Z"}],["meta",{"property":"article:tag","content":"Nginx"}],["meta",{"property":"article:modified_time","content":"2025-02-27T03:26:46.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Nginx知识点\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-02-27T03:26:46.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"宋涛\\",\\"url\\":\\"https://java-st.blog.csdn.net/\\"}]}"]]},"headers":[{"level":2,"title":"目录","slug":"目录","link":"#目录","children":[]},{"level":2,"title":"1. NGINX 简介","slug":"_1-nginx-简介","link":"#_1-nginx-简介","children":[{"level":3,"title":"什么是 NGINX？","slug":"什么是-nginx","link":"#什么是-nginx","children":[]}]},{"level":2,"title":"2. NGINX 安装与启动","slug":"_2-nginx-安装与启动","link":"#_2-nginx-安装与启动","children":[{"level":3,"title":"安装 NGINX","slug":"安装-nginx","link":"#安装-nginx","children":[]},{"level":3,"title":"启动与停止服务","slug":"启动与停止服务","link":"#启动与停止服务","children":[]}]},{"level":2,"title":"3. 核心配置与结构","slug":"_3-核心配置与结构","link":"#_3-核心配置与结构","children":[{"level":3,"title":"NGINX 配置文件路径","slug":"nginx-配置文件路径","link":"#nginx-配置文件路径","children":[]},{"level":3,"title":"配置文件结构","slug":"配置文件结构","link":"#配置文件结构","children":[]}]},{"level":2,"title":"4. NGINX 基本命令","slug":"_4-nginx-基本命令","link":"#_4-nginx-基本命令","children":[]},{"level":2,"title":"5. NGINX 的常见场景与配置","slug":"_5-nginx-的常见场景与配置","link":"#_5-nginx-的常见场景与配置","children":[{"level":3,"title":"5.1 静态文件服务","slug":"_5-1-静态文件服务","link":"#_5-1-静态文件服务","children":[]},{"level":3,"title":"5.2 HTTP 转发与反向代理","slug":"_5-2-http-转发与反向代理","link":"#_5-2-http-转发与反向代理","children":[]},{"level":3,"title":"5.3 负载均衡","slug":"_5-3-负载均衡","link":"#_5-3-负载均衡","children":[]},{"level":3,"title":"5.4 HTTPS 配置","slug":"_5-4-https-配置","link":"#_5-4-https-配置","children":[]}]},{"level":2,"title":"6. 模块与高级功能","slug":"_6-模块与高级功能","link":"#_6-模块与高级功能","children":[{"level":3,"title":"常用模块列表","slug":"常用模块列表","link":"#常用模块列表","children":[]},{"level":3,"title":"日志设置","slug":"日志设置","link":"#日志设置","children":[]}]},{"level":2,"title":"7. 性能优化技巧","slug":"_7-性能优化技巧","link":"#_7-性能优化技巧","children":[]},{"level":2,"title":"8. NGINX 常见问题与排查","slug":"_8-nginx-常见问题与排查","link":"#_8-nginx-常见问题与排查","children":[{"level":3,"title":"问题一：服务启动失败","slug":"问题一-服务启动失败","link":"#问题一-服务启动失败","children":[]},{"level":3,"title":"问题二：高并发流量引发 504 Gateway Timeout","slug":"问题二-高并发流量引发-504-gateway-timeout","link":"#问题二-高并发流量引发-504-gateway-timeout","children":[]}]},{"level":2,"title":"9. 总结","slug":"_9-总结","link":"#_9-总结","children":[]}],"git":{"createdTime":1740584260000,"updatedTime":1740626806000,"contributors":[{"name":"stao","username":"stao","email":"2944922490@qq.com","commits":3,"url":"https://github.com/stao"}]},"readingTime":{"minutes":4.31,"words":1293},"filePathRelative":"article/Linux/Nginx知识点.md","localizedDate":"2025年2月26日","excerpt":"<p>NGINX 是一个高性能的 HTTP 和反向代理服务器，支持高并发、负载均衡等功能，被广泛用于网站流量分发和高可用集群部署，也是现代 Web 开发和运维的核心组件之一。</p>\\n<p><strong>本文梳理了 NGINX 从基础到高级的全面知识，旨在帮助读者快速入门及掌握核心技能。</strong></p>\\n","autoDesc":true}');export{g as comp,c as data};
