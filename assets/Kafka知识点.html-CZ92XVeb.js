import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,d as s,a as l,b as t,o as n}from"./app-B14rnIJD.js";const h={};function r(k,i){return n(),e("div",null,[i[0]||(i[0]=s("p",null,"Apache Kafka 是一款由 Apache 软件基金会开发的高吞吐量分布式消息队列，常用于处理实时数据流。Kafka 以发布-订阅模式、高扩展性和持久性著称，是现代分布式系统中的核心组件之一。",-1)),i[1]||(i[1]=s("p",null,"本文将完整梳理 Kafka 的基础概念、安装与配置、核心架构、使用方式，以及常见场景与优化技巧。",-1)),l(" more "),i[2]||(i[2]=t(`<h2 id="目录" tabindex="-1"><a class="header-anchor" href="#目录"><span>目录</span></a></h2><ol><li><a href="#1-kafka-%E7%AE%80%E4%BB%8B">Kafka 简介</a></li><li><a href="#2-kafka-%E6%A0%B8%E5%BF%83%E6%9E%B6%E6%9E%84">Kafka 核心架构</a></li><li><a href="#3-%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE">安装与配置</a></li><li><a href="#4-kafka-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C">Kafka 基本操作</a></li><li><a href="#5-kafka-%E9%AB%98%E7%BA%A7%E5%8A%9F%E8%83%BD">Kafka 高级功能</a></li><li><a href="#6-kafka-%E5%B8%B8%E8%A7%81%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF">Kafka 常见使用场景</a></li><li><a href="#7-kafka-%E9%AB%98%E7%BA%A7%E4%BC%98%E5%8C%96%E4%B8%8E%E8%B0%83%E4%BC%98">Kafka 高级优化与调优</a></li><li><a href="#8-%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98">故障排查常见问题</a></li><li><a href="#9-%E6%80%BB%E7%BB%93">总结</a></li></ol><hr><h2 id="_1-kafka-简介" tabindex="-1"><a class="header-anchor" href="#_1-kafka-简介"><span>1. Kafka 简介</span></a></h2><p>Apache Kafka 是最初由 LinkedIn 开发并在 2011 年开源的分布式事件流处理平台，主要用于以下场景：</p><ul><li><strong>消息队列</strong>：处理生产者（Producer）与消费者（Consumer）之间的异步消息通信。</li><li><strong>事件流处理</strong>：实时处理和分析日志、指标等时间序列数据。</li><li><strong>日志存储</strong>：分布式的持久化日志存储和分析。</li></ul><hr><h3 id="kafka-的核心特点" tabindex="-1"><a class="header-anchor" href="#kafka-的核心特点"><span>Kafka 的核心特点</span></a></h3><ol><li><strong>高吞吐量</strong>：每秒可处理数百万条消息，适用于大数据场景。</li><li><strong>水平扩展性</strong>：可轻松扩展至数百个节点。</li><li><strong>持久化与可靠性</strong>：通过日志分片保存消息，并支持消息 ACK 机制。</li><li><strong>高可用性</strong>：使用分区（Partition）与副本（Replica）机制进行故障恢复。</li></ol><hr><h2 id="_2-kafka-核心架构" tabindex="-1"><a class="header-anchor" href="#_2-kafka-核心架构"><span>2. Kafka 核心架构</span></a></h2><h3 id="kafka-的角色与组件" tabindex="-1"><a class="header-anchor" href="#kafka-的角色与组件"><span>Kafka 的角色与组件</span></a></h3><table><thead><tr><th>角色</th><th>描述</th></tr></thead><tbody><tr><td><strong>Producer</strong></td><td>消息生产者，向 Kafka 的一个或多个 Topic 写入数据。</td></tr><tr><td><strong>Consumer</strong></td><td>消息消费者，从 Kafka 的一个或多个 Topic 中消费数据。</td></tr><tr><td><strong>Topic</strong></td><td>主题，逻辑上的数据分组，相当于数据的分类标签。</td></tr><tr><td><strong>Partition</strong></td><td>消息分区，每个 Topic 可划分为多个 Partition，并分布在多个 Broker 上。</td></tr><tr><td><strong>Broker</strong></td><td>Kafka 的独立实例（服务器），负责存储分区消息并处理消费请求。</td></tr><tr><td><strong>Zookeeper</strong></td><td>Kafka 使用 Zookeeper 来进行分布式协调与元数据管理（Kafka 3.0+ 开始移除）。</td></tr></tbody></table><hr><h3 id="数据流过程" tabindex="-1"><a class="header-anchor" href="#数据流过程"><span>数据流过程</span></a></h3><ol><li>Producer 向指定的 Topic 写入消息。</li><li>Kafka Broker 将消息存储到对应的 Partition。</li><li>Consumer 从指定的 Partition 消费消息，经过 Offset 管理保证有序消费。</li></ol><hr><h3 id="核心术语" tabindex="-1"><a class="header-anchor" href="#核心术语"><span>核心术语</span></a></h3><table><thead><tr><th>术语</th><th>描述</th></tr></thead><tbody><tr><td><strong>Partition</strong></td><td>Topic 的最小分片，数据按照分区存储，可以并行处理。</td></tr><tr><td><strong>Replica</strong></td><td>每个分区的复制副本，用于容灾与故障恢复。</td></tr><tr><td><strong>Offset</strong></td><td>消息在分区中的唯一标识，用于标志消息的消费进度。</td></tr><tr><td><strong>Consumer Group</strong></td><td>消费者组，同一组内的 Consumer 会分摊消费某个 Topic 的分区。</td></tr></tbody></table><hr><h2 id="_3-安装与配置" tabindex="-1"><a class="header-anchor" href="#_3-安装与配置"><span>3. 安装与配置</span></a></h2><h3 id="_3-1-安装-kafka" tabindex="-1"><a class="header-anchor" href="#_3-1-安装-kafka"><span>3.1 安装 Kafka</span></a></h3><h4 id="环境准备" tabindex="-1"><a class="header-anchor" href="#环境准备"><span>环境准备</span></a></h4><ul><li>Java 安装（推荐 JDK 8 或更高版本）。</li><li>Zookeeper：Kafka 低版本依赖 Zookeeper，Kafka 3.0+ 可单独运行。</li></ul><hr><h3 id="下载与安装-单机部署" tabindex="-1"><a class="header-anchor" href="#下载与安装-单机部署"><span>下载与安装（单机部署）</span></a></h3><ol><li><p>下载 Kafka：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://downloads.apache.org/kafka/3.4.0/kafka_2.13-3.4.0.tgz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -xvzf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kafka_2.13-3.4.0.tgz</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kafka_2.13-3.4.0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>启动 Zookeeper：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bin/zookeeper-server-start.sh</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> config/zookeeper.properties</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>启动 Kafka Broker：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bin/kafka-server-start.sh</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> config/server.properties</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>验证安装：<br> 创建 Topic，生产与消费测试：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建 Topic</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bin/kafka-topics.sh</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --create</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --topic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test-topic</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --bootstrap-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> localhost:9092</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --replication-factor</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --partitions</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 测试生产者</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bin/kafka-console-producer.sh</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --topic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test-topic</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --bootstrap-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> localhost:9092</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 测试消费者</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bin/kafka-console-consumer.sh</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --topic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test-topic</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --from-beginning</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --bootstrap-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> localhost:9092</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><hr><h3 id="_3-2-配置文件详解" tabindex="-1"><a class="header-anchor" href="#_3-2-配置文件详解"><span>3.2 配置文件详解</span></a></h3><p>Kafka 的核心配置文件包括以下几个：</p><ul><li><p><strong><code>server.properties</code></strong>（Kafka Broker 配置）：</p><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" data-title="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">broker.id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">1                           </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 节点 ID，集群中唯一</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">log.dirs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">/tmp/kafka-logs              </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 数据存储路径</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">zookeeper.connect</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">localhost:2181      </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Zookeeper 地址</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">num.partitions</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">3                      </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 默认分区数</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">offsets.retention.minutes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">1440        </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Offset 数据保存时间</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong><code>producer.properties</code></strong> 和 <strong><code>consumer.properties</code></strong> 用于配置生产者和消费者行为。</p></li></ul><hr><h2 id="_4-kafka-基本操作" tabindex="-1"><a class="header-anchor" href="#_4-kafka-基本操作"><span>4. Kafka 基本操作</span></a></h2><h3 id="topic-操作" tabindex="-1"><a class="header-anchor" href="#topic-操作"><span>Topic 操作</span></a></h3><ol><li><p>查看现有 Topics：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bin/kafka-topics.sh</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --list</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --bootstrap-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> localhost:9092</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>创建 Topic：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bin/kafka-topics.sh</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --create</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --topic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> my-topic</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --bootstrap-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> localhost:9092</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --partitions</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --replication-factor</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>删除 Topic（需开启删除功能）：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bin/kafka-topics.sh</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --delete</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --topic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> my-topic</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --bootstrap-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> localhost:9092</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ol><hr><h3 id="消息生产与消费" tabindex="-1"><a class="header-anchor" href="#消息生产与消费"><span>消息生产与消费</span></a></h3><ol><li><p>启动生产者和消费者，向 Topic 写入并读取消息：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bin/kafka-console-producer.sh</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --topic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> my-topic</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --bootstrap-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> localhost:9092</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bin/kafka-console-consumer.sh</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --topic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> my-topic</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --from-beginning</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --bootstrap-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> localhost:9092</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>消费指定分区的消息：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bin/kafka-console-consumer.sh</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --topic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> my-topic</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --partition</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --bootstrap-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> localhost:9092</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ol><hr><h2 id="_5-kafka-高级功能" tabindex="-1"><a class="header-anchor" href="#_5-kafka-高级功能"><span>5. Kafka 高级功能</span></a></h2><h3 id="_5-1-分区与副本机制" tabindex="-1"><a class="header-anchor" href="#_5-1-分区与副本机制"><span>5.1 分区与副本机制</span></a></h3><ul><li><strong>分区（Partition）</strong>：提供水平扩展能力，支持并行处理。</li><li><strong>副本（Replication）</strong>：保证数据可靠，每个分区有 N 个副本，划分为： <ul><li><strong>Leader 副本</strong>：处理读写请求。</li><li><strong>Follower 副本</strong>：保持与 Leader 数据一致。</li></ul></li></ul><hr><h3 id="_5-2-consumer-group" tabindex="-1"><a class="header-anchor" href="#_5-2-consumer-group"><span>5.2 Consumer Group</span></a></h3><ul><li><strong>作用</strong>： <ul><li>实现负载均衡，通过多个消费者分摊消费压力。</li><li>提高并发消费能力。</li></ul></li><li><strong>注意事项</strong>： <ul><li>如果 Consumer Group 的成员数超过分区数，多余的 Consumer 会闲置。</li></ul></li></ul><hr><h3 id="_5-3-数据可靠性与持久性" tabindex="-1"><a class="header-anchor" href="#_5-3-数据可靠性与持久性"><span>5.3 数据可靠性与持久性</span></a></h3><ul><li><strong>ACK 机制</strong>：<br> 生产者可设置消息确认级别： <ul><li><code>acks=0</code>：不等待确认，吞吐量高但数据可能丢失。</li><li><code>acks=1</code>：等待 Leader 确认。</li><li><code>acks=all</code>：等待所有副本确认，提升可靠性。</li></ul></li></ul><hr><h2 id="_6-kafka-常见使用场景" tabindex="-1"><a class="header-anchor" href="#_6-kafka-常见使用场景"><span>6. Kafka 常见使用场景</span></a></h2><ol><li><strong>实时日志与监控</strong>： <ul><li>收集网站访问日志，并实时数据流分析。</li></ul></li><li><strong>消息代理</strong>： <ul><li>实现应用解耦与异步通信。</li></ul></li><li><strong>事件驱动架构</strong>： <ul><li>消费者根据事件触发特定业务逻辑。</li></ul></li><li><strong>数据聚合与流处理</strong>： <ul><li>用于处理多来源数据并进行动态分析，如使用 Kafka Streams 或 Flink。</li></ul></li><li><strong>分布式事务的实现</strong>： <ul><li>通过 Kafka 实现幂等性消息消费或分布式事务的投递确认。</li></ul></li></ol><hr><h2 id="_7-kafka-高级优化与调优" tabindex="-1"><a class="header-anchor" href="#_7-kafka-高级优化与调优"><span>7. Kafka 高级优化与调优</span></a></h2><h3 id="_7-1-性能优化" tabindex="-1"><a class="header-anchor" href="#_7-1-性能优化"><span>7.1 性能优化</span></a></h3><ol><li><p>调整分区：</p><ul><li>增加分区提高吞吐量，但分区过多会导致管理难度增加。</li></ul></li><li><p>批次发送：</p><ul><li>配置生产者批处理参数：<div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" data-title="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">batch.size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">16384</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">linger.ms</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">5</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li><p>提高磁盘 I/O性能：</p><ul><li>利用 RAID、SSD 存储等方式。</li></ul></li></ol><hr><h3 id="_7-2-配置调优关键点" tabindex="-1"><a class="header-anchor" href="#_7-2-配置调优关键点"><span>7.2 配置调优关键点</span></a></h3><ul><li><strong>生产者优化</strong>： <ul><li>使用 Snappy 压缩消息。</li></ul></li><li><strong>消费者优化</strong>： <ul><li>提高消费并行度，合理分配消费线程。</li></ul></li><li><strong>Broker 优化</strong>： <ul><li>增加 Broker 数量，减少每个 Broker 负载。</li></ul></li></ul><hr><h2 id="_8-故障排查常见问题" tabindex="-1"><a class="header-anchor" href="#_8-故障排查常见问题"><span>8. 故障排查常见问题</span></a></h2><ol><li><p><strong>生产者无法连接 Kafka</strong>：</p><ul><li>检查 <code>advertised.listeners</code> 是否正确。</li><li>确保防火墙未限制 Kafka 所用端口。</li></ul></li><li><p><strong>消费者重复消费或丢失消息</strong>：</p><ul><li>配置 <code>enable.auto.commit=false</code>，手动管理 Offset 提交。</li></ul></li><li><p><strong>数据延迟问题</strong>：</p><ul><li>提高分区数，缩短批处理时间。</li></ul></li><li><p>Windows运行kafka-server-start一闪而过的黑框</p></li></ol><hr><h2 id="_9-总结" tabindex="-1"><a class="header-anchor" href="#_9-总结"><span>9. 总结</span></a></h2><p>Kafka 是现代分布式系统中处理实时数据流的关键工具，其可靠性、高吞吐量和水平扩展能力，使得它成为分布式消息中间件领域的佼佼者。本文简要介绍了 Kafka 的基础概念、安装配置及高级功能，建议读者结合项目场景深入实践，逐步理解其架构设计与优化策略。</p><p>官方文档：<a href="https://kafka.apache.org/documentation/" target="_blank" rel="noopener noreferrer">Kafka 官网文档</a></p>`,65))])}const o=a(h,[["render",r],["__file","Kafka知识点.html.vue"]]),c=JSON.parse('{"path":"/article/Linux/Kafka%E7%9F%A5%E8%AF%86%E7%82%B9.html","title":"Kafka知识点","lang":"zh-CN","frontmatter":{"title":"Kafka知识点","category":["Linux"],"tag":["Kafka"],"description":"Apache Kafka 是一款由 Apache 软件基金会开发的高吞吐量分布式消息队列，常用于处理实时数据流。Kafka 以发布-订阅模式、高扩展性和持久性著称，是现代分布式系统中的核心组件之一。 本文将完整梳理 Kafka 的基础概念、安装与配置、核心架构、使用方式，以及常见场景与优化技巧。","head":[["meta",{"property":"og:url","content":"https://java-st.blog.csdn.net/my-blog/article/Linux/Kafka%E7%9F%A5%E8%AF%86%E7%82%B9.html"}],["meta",{"property":"og:site_name","content":"知识库"}],["meta",{"property":"og:title","content":"Kafka知识点"}],["meta",{"property":"og:description","content":"Apache Kafka 是一款由 Apache 软件基金会开发的高吞吐量分布式消息队列，常用于处理实时数据流。Kafka 以发布-订阅模式、高扩展性和持久性著称，是现代分布式系统中的核心组件之一。 本文将完整梳理 Kafka 的基础概念、安装与配置、核心架构、使用方式，以及常见场景与优化技巧。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-03-03T08:49:22.000Z"}],["meta",{"property":"article:tag","content":"Kafka"}],["meta",{"property":"article:modified_time","content":"2025-03-03T08:49:22.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Kafka知识点\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-03-03T08:49:22.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"宋涛\\",\\"url\\":\\"https://java-st.blog.csdn.net/\\"}]}"]]},"headers":[{"level":2,"title":"目录","slug":"目录","link":"#目录","children":[]},{"level":2,"title":"1. Kafka 简介","slug":"_1-kafka-简介","link":"#_1-kafka-简介","children":[{"level":3,"title":"Kafka 的核心特点","slug":"kafka-的核心特点","link":"#kafka-的核心特点","children":[]}]},{"level":2,"title":"2. Kafka 核心架构","slug":"_2-kafka-核心架构","link":"#_2-kafka-核心架构","children":[{"level":3,"title":"Kafka 的角色与组件","slug":"kafka-的角色与组件","link":"#kafka-的角色与组件","children":[]},{"level":3,"title":"数据流过程","slug":"数据流过程","link":"#数据流过程","children":[]},{"level":3,"title":"核心术语","slug":"核心术语","link":"#核心术语","children":[]}]},{"level":2,"title":"3. 安装与配置","slug":"_3-安装与配置","link":"#_3-安装与配置","children":[{"level":3,"title":"3.1 安装 Kafka","slug":"_3-1-安装-kafka","link":"#_3-1-安装-kafka","children":[]},{"level":3,"title":"下载与安装（单机部署）","slug":"下载与安装-单机部署","link":"#下载与安装-单机部署","children":[]},{"level":3,"title":"3.2 配置文件详解","slug":"_3-2-配置文件详解","link":"#_3-2-配置文件详解","children":[]}]},{"level":2,"title":"4. Kafka 基本操作","slug":"_4-kafka-基本操作","link":"#_4-kafka-基本操作","children":[{"level":3,"title":"Topic 操作","slug":"topic-操作","link":"#topic-操作","children":[]},{"level":3,"title":"消息生产与消费","slug":"消息生产与消费","link":"#消息生产与消费","children":[]}]},{"level":2,"title":"5. Kafka 高级功能","slug":"_5-kafka-高级功能","link":"#_5-kafka-高级功能","children":[{"level":3,"title":"5.1 分区与副本机制","slug":"_5-1-分区与副本机制","link":"#_5-1-分区与副本机制","children":[]},{"level":3,"title":"5.2 Consumer Group","slug":"_5-2-consumer-group","link":"#_5-2-consumer-group","children":[]},{"level":3,"title":"5.3 数据可靠性与持久性","slug":"_5-3-数据可靠性与持久性","link":"#_5-3-数据可靠性与持久性","children":[]}]},{"level":2,"title":"6. Kafka 常见使用场景","slug":"_6-kafka-常见使用场景","link":"#_6-kafka-常见使用场景","children":[]},{"level":2,"title":"7. Kafka 高级优化与调优","slug":"_7-kafka-高级优化与调优","link":"#_7-kafka-高级优化与调优","children":[{"level":3,"title":"7.1 性能优化","slug":"_7-1-性能优化","link":"#_7-1-性能优化","children":[]},{"level":3,"title":"7.2 配置调优关键点","slug":"_7-2-配置调优关键点","link":"#_7-2-配置调优关键点","children":[]}]},{"level":2,"title":"8. 故障排查常见问题","slug":"_8-故障排查常见问题","link":"#_8-故障排查常见问题","children":[]},{"level":2,"title":"9. 总结","slug":"_9-总结","link":"#_9-总结","children":[]}],"git":{"createdTime":1740584260000,"updatedTime":1740991762000,"contributors":[{"name":"stao","username":"stao","email":"2944922490@qq.com","commits":4,"url":"https://github.com/stao"}]},"readingTime":{"minutes":5.91,"words":1774},"filePathRelative":"article/Linux/Kafka知识点.md","localizedDate":"2025年2月26日","excerpt":"<p>Apache Kafka 是一款由 Apache 软件基金会开发的高吞吐量分布式消息队列，常用于处理实时数据流。Kafka 以发布-订阅模式、高扩展性和持久性著称，是现代分布式系统中的核心组件之一。</p>\\n<p>本文将完整梳理 Kafka 的基础概念、安装与配置、核心架构、使用方式，以及常见场景与优化技巧。</p>\\n","autoDesc":true}');export{o as comp,c as data};
